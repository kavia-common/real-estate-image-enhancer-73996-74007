{"is_source_file": true, "format": "Python", "description": "This file is a FastAPI route module for administrative endpoints in a backend application. It defines API routes for listing users, retrieving usage statistics, fetching audit logs, and toggling user status, along with internal dependencies and security checks.", "external_files": ["src/utils/security.py", "src/models/user.py", "src/models/image.py", "src/models/audit_log.py", "src/schemas.py"], "external_methods": ["get_db", "get_current_active_user"], "published": ["list_users", "get_usage_stats", "get_audit_logs", "toggle_user_status"], "classes": [], "methods": [{"name": "get_admin_user(current_user: User = Depends(get_current_active_user))", "description": "Ensures that the current user has admin privileges, raising HTTP 403 if not.", "scope": "", "scopeKind": ""}, {"name": "list_users( skip: int = 0, limit: int = 100, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )", "description": "Retrieves a paginated list of all users.", "scope": "", "scopeKind": ""}, {"name": "get_usage_stats( days: int = 30, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )", "description": "Gathers platform usage and image processing statistics for the specified number of days.", "scope": "", "scopeKind": ""}, {"name": "get_audit_logs( user_id: int = None, action: str = None, skip: int = 0, limit: int = 100, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )", "description": "Fetches audit logs with optional filtering by user and action.", "scope": "", "scopeKind": ""}, {"name": "toggle_user_status( user_id: int, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )", "description": "Toggles the is_active status of a specific user.", "scope": "", "scopeKind": ""}], "calls": ["db.query", "db.commit", "db.query(User).count()", "db.query(User).filter(...)", "db.query(Image).filter(...)", "db.query(AuditLog).filter(...)", "db.query(AuditLog).order_by(...)"], "search-terms": ["admin routes", "usage statistics", "audit logs", "user toggle", "FastAPI APIRouter", "Security dependency", "Image model stats", "AuditLog filtering"], "state": 2, "file_id": 19, "knowledge_revision": 48, "git_revision": "", "ctags": [{"_type": "tag", "name": "AuditLogSchema", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^from src.schemas import User as UserSchema, AuditLog as AuditLogSchema$/", "language": "Python", "kind": "unknown", "nameref": "unknown:AuditLog"}, {"_type": "tag", "name": "UserSchema", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^from src.schemas import User as UserSchema, AuditLog as AuditLogSchema$/", "language": "Python", "kind": "unknown", "nameref": "unknown:User"}, {"_type": "tag", "name": "get_admin_user", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^async def get_admin_user(current_user: User = Depends(get_current_active_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: User = Depends(get_current_active_user))"}, {"_type": "tag", "name": "get_audit_logs", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^async def get_audit_logs($/", "language": "Python", "kind": "function", "signature": "( user_id: int = None, action: str = None, skip: int = 0, limit: int = 100, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "get_usage_stats", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^async def get_usage_stats($/", "language": "Python", "kind": "function", "signature": "( days: int = 30, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "list_users", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^async def list_users($/", "language": "Python", "kind": "function", "signature": "( skip: int = 0, limit: int = 100, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "toggle_user_status", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/admin.py", "pattern": "/^async def toggle_user_status($/", "language": "Python", "kind": "function", "signature": "( user_id: int, admin_user: User = Depends(get_admin_user), db: Session = Depends(get_db) )"}], "hash": "14d67f264700203b085a90f2e52fd2ee", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/routes/admin.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"48": ""}]}
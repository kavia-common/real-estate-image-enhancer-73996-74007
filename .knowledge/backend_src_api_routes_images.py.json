{"is_source_file": true, "format": "Python (FastAPI)", "description": "This file defines API endpoints for managing images in a backend service. It includes routes for uploading images, listing images, retrieving specific images, and deleting images. The code handles user subscription validation, file saving, database interactions, asynchronous image processing, and audit logging.", "external_files": ["src.utils.security", "src.models.user", "src.models.image", "src.schemas", "src.utils.google_api", "src.utils.audit", "src.utils.file_handler", "src.utils.config"], "external_methods": ["get_db", "get_current_active_user", "process_image", "log_audit_event", "save_upload_file", "delete_file"], "published": ["upload_image", "list_images", "get_image", "delete_image"], "classes": [], "methods": [{"name": "upload_image( file: UploadFile = File(...), edit_request: str = None, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )", "description": "Handles uploading and processing of a new image, including subscription checks, saving the file, database record creation, async processing, and audit logging.", "scope": "", "scopeKind": ""}, {"name": "list_images( skip: int = 0, limit: int = 20, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )", "description": "Retrieves a paginated list of images belonging to the current user.", "scope": "", "scopeKind": ""}, {"name": "get_image( image_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )", "description": "Fetches a specific image by its ID for the current user.", "scope": "", "scopeKind": ""}, {"name": "delete_image( image_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )", "description": "Deletes an image and its associated files, logs the deletion event, and handles errors gracefully.", "scope": "", "scopeKind": ""}], "calls": ["save_upload_file", "process_image", "log_audit_event", "delete_file", "db.add", "db.commit", "db.refresh", "db.query", "db.delete"], "search-terms": ["images upload endpoint", "user subscription validation", "async image processing", "image delete cleanup", "audit logging"], "state": 2, "file_id": 13, "knowledge_revision": 58, "git_revision": "", "revision_history": [{"27": ""}, {"37": ""}, {"58": ""}], "ctags": [{"_type": "tag", "name": "ImageSchema", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^from src.schemas import Image as ImageSchema$/", "language": "Python", "kind": "unknown", "nameref": "unknown:Image"}, {"_type": "tag", "name": "delete_image", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^async def delete_image($/", "language": "Python", "kind": "function", "signature": "( image_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "get_image", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^async def get_image($/", "language": "Python", "kind": "function", "signature": "( image_id: int, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "list_images", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^async def list_images($/", "language": "Python", "kind": "function", "signature": "( skip: int = 0, limit: int = 20, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "settings", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "upload_image", "path": "/home/kavia/workspace/code-generation/real-estate-image-enhancer-73996-74007/backend/src/api/routes/images.py", "pattern": "/^async def upload_image($/", "language": "Python", "kind": "function", "signature": "( file: UploadFile = File(...), edit_request: str = None, current_user: User = Depends(get_current_active_user), db: Session = Depends(get_db) )"}], "hash": "2d5f0ad42ba60f5cf746b57dc672615b", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/routes/images.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}]}